<!doctype html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<head>
    <title>Python: module swmixer</title>
</head>

<body bgcolor="#f0f0f8">

    <table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
        <tr bgcolor="#7799ee">
            <td valign=bottom> <br>
                <font color="#ffffff" face="helvetica, arial"> <br><big><big><strong>swmixer</strong></big></big>
                </font>
            </td>
            <td align=right valign=bottom>
                <font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a
                        href="file:/home/nwhitehe/Projects/pygalaxy/swmixer/swmixer.py">/home/nwhitehe/Projects/pygalaxy/swmixer/swmixer.py</a>
                </font>
            </td>
        </tr>
    </table>
    <p><tt>Advanced Realtime Software Mixer<br>
             <br>
            This module implements an advanced realtime sound mixer suitable for<br>
            use in games or other audio applications.  It supports loading sounds<br>
            in uncompressed WAV format.  It can mix several sounds together during<br>
            playback.  The volume and position of each sound can be finely<br>
            controlled.  The mixer can use a separate thread so clients never block<br>
            during operations.  Samples can also be looped any number of times.<br>
            Looping is accurate down to a single sample, so well designed loops<br>
            will play seamlessly.  Also supports sound recording during playback.<br>
             <br>
            Copyright 2008, Nathan Whitehead<br>
            Released under the LGPL</tt></p>
    <p>
    <table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
        <tr bgcolor="#aa55cc">
            <td colspan=3 valign=bottom> <br>
                <font color="#fffff" face="helvetica, arial"><big><strong>Modules</strong></big></font>
            </td>
        </tr>

        <tr>
            <td bgcolor="#aa55cc"><tt>      </tt></td>
            <td> </td>
            <td width="100%">
                <table width="100%" summary="list">
                    <tr>
                        <td width="25%" valign=top><a href="mad.html">mad</a><br>
                            <a href="numpy.html">numpy</a><br>
                        </td>
                        <td width="25%" valign=top><a href="pyaudio.html">pyaudio</a><br>
                            <a href="thread.html">thread</a><br>
                        </td>
                        <td width="25%" valign=top><a href="time.html">time</a><br>
                            <a href="wave.html">wave</a><br>
                        </td>
                        <td width="25%" valign=top></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    <p>
    <table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
        <tr bgcolor="#ee77aa">
            <td colspan=3 valign=bottom> <br>
                <font color="#ffffff" face="helvetica, arial"><big><strong>Classes</strong></big></font>
            </td>
        </tr>

        <tr>
            <td bgcolor="#ee77aa"><tt>      </tt></td>
            <td> </td>
            <td width="100%">
                <dl>
                    <dt>
                        <font face="helvetica, arial"><a href="swmixer.html#Channel">Channel</a>
                        </font>
                    </dt>
                    <dt>
                        <font face="helvetica, arial"><a href="swmixer.html#Sound">Sound</a>
                        </font>
                    </dt>
                    <dt>
                        <font face="helvetica, arial"><a href="swmixer.html#StreamingSound">StreamingSound</a>
                        </font>
                    </dt>
                </dl>
                <p>
                <table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
                    <tr bgcolor="#ffc8d8">
                        <td colspan=3 valign=bottom> <br>
                            <font color="#000000" face="helvetica, arial"><a name="Channel">class
                                    <strong>Channel</strong></a></font>
                        </td>
                    </tr>

                    <tr bgcolor="#ffc8d8">
                        <td rowspan=2><tt>   </tt></td>
                        <td colspan=2>
                            <tt>Represents one sound source currently playing<br> </tt>
                        </td>
                    </tr>
                    <tr>
                        <td> </td>
                        <td width="100%">Methods defined here:<br>
                            <dl>
                                <dt><a name="Channel-__init__"><strong>__init__</strong></a>(self, src, env)</dt>
                            </dl>

                            <dl>
                                <dt><a name="Channel-fadeout"><strong>fadeout</strong></a>(self, time)</dt>
                                <dd><tt>Schedule a fadeout of this sound in given time</tt>
                                </dd>
                            </dl>

                            <dl>
                                <dt><a name="Channel-get_position"><strong>get_position</strong></a>(self)</dt>
                                <dd><tt>Return current position of sound in samples</tt>
                                </dd>
                            </dl>

                            <dl>
                                <dt><a name="Channel-get_volume"><strong>get_volume</strong></a>(self)</dt>
                                <dd><tt>Return current volume of sound</tt></dd>
                            </dl>

                            <dl>
                                <dt><a name="Channel-pause"><strong>pause</strong></a>(self)</dt>
                                <dd><tt>Pause the sound temporarily</tt></dd>
                            </dl>

                            <dl>
                                <dt><a name="Channel-set_position"><strong>set_position</strong></a>(self, p)</dt>
                                <dd><tt>Set current position of sound in samples</tt></dd>
                            </dl>

                            <dl>
                                <dt><a name="Channel-set_volume"><strong>set_volume</strong></a>(self, v, fadetime<font
                                        color="#909090">=0</font>)</dt>
                                <dd><tt>Set the volume of the sound<br>
                                         <br>
                                        Removes any previously set envelope information.  Also<br>
                                        overrides any pending fadeins or fadeouts.</tt></dd>
                            </dl>

                            <dl>
                                <dt><a name="Channel-stop"><strong>stop</strong></a>(self)</dt>
                                <dd><tt>Stop the sound playing</tt></dd>
                            </dl>

                            <dl>
                                <dt><a name="Channel-unpause"><strong>unpause</strong></a>(self)</dt>
                                <dd><tt>Unpause a previously paused sound</tt></dd>
                            </dl>

                        </td>
                    </tr>
                </table>
                <p>
                <table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
                    <tr bgcolor="#ffc8d8">
                        <td colspan=3 valign=bottom> <br>
                            <font color="#000000" face="helvetica, arial"><a name="Sound">class
                                    <strong>Sound</strong></a></font>
                        </td>
                    </tr>

                    <tr bgcolor="#ffc8d8">
                        <td rowspan=2><tt>   </tt></td>
                        <td colspan=2><tt>Represents a playable sound<br> </tt></td>
                    </tr>
                    <tr>
                        <td> </td>
                        <td width="100%">Methods defined here:<br>
                            <dl>
                                <dt><a name="Sound-__init__"><strong>__init__</strong></a>(self, filename<font
                                        color="#909090">=None</font>, data<font color="#909090">=None</font>)</dt>
                                <dd><tt>Create new sound from a WAV file, MP3 file, or explicit sample data</tt>
                                </dd>
                            </dl>

                            <dl>
                                <dt><a name="Sound-get_length"><strong>get_length</strong></a>(self)</dt>
                                <dd><tt>Return the length of the sound in samples<br>
                                         <br>
                                        To convert to seconds, divide by the samplerate and then divide<br>
                                        by 2 if in stereo.</tt></dd>
                            </dl>

                            <dl>
                                <dt><a name="Sound-play"><strong>play</strong></a>(self, volume<font color="#909090">
                                        =1.0</font>, offset<font color="#909090">=0</font>, fadein<font color="#909090">
                                        =0</font>, envelope<font color="#909090">=None</font>, loops<font
                                        color="#909090">=0</font>)</dt>
                                <dd><tt>Play the sound<br>
                                         <br>
                                        Keyword arguments:<br>
                                        volume - volume to play sound at<br>
                                        offset - sample to start playback<br>
                                        fadein - number of samples to slowly fade in volume<br>
                                        envelope - a list of [offset, volume] pairs defining<br>
                                                   a linear volume envelope<br>
                                        loops - how many times to play the sound (-1 is infinite)</tt>
                                </dd>
                            </dl>

                            <dl>
                                <dt><a name="Sound-resample"><strong>resample</strong></a>(self, scale)</dt>
                                <dd><tt>Resample a sound<br>
                                         <br>
                                        scale = 1.0 means original sound<br>
                                        scale = 0.5 is half as long (up an octave)<br>
                                        scale = 2.0 is twice as long (down an octave)</tt>
                                </dd>
                            </dl>

                            <dl>
                                <dt><a name="Sound-scale"><strong>scale</strong></a>(self, vol)</dt>
                                <dd><tt>Scale a sound sample<br>
                                         <br>
                                        vol is 0.0 to 1.0, amount to scale by</tt>
                                </dd>
                            </dl>

                        </td>
                    </tr>
                </table>
                <p>
                <table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
                    <tr bgcolor="#ffc8d8">
                        <td colspan=3 valign=bottom> <br>
                            <font color="#000000" face="helvetica, arial"><a name="StreamingSound">class
                                    <strong>StreamingSound</strong></a></font>
                        </td>
                    </tr>

                    <tr bgcolor="#ffc8d8">
                        <td rowspan=2><tt>   </tt></td>
                        <td colspan=2><tt>Represents a playable sound stream<br> </tt></td>
                    </tr>
                    <tr>
                        <td> </td>
                        <td width="100%">Methods defined here:<br>
                            <dl>
                                <dt><a name="StreamingSound-__init__"><strong>__init__</strong></a>(self, filename,
                                    checks<font color="#909090">=True</font>)</dt>
                                <dd><tt>Create new streaming sound from a WAV file or an MP3 file<br>
                                         <br>
                                        The new streaming sound must match the output samplerate<br>
                                        and stereo-ness.  You can turn off these checks by setting<br>
                                        the keyword checks=False, but the sound will be distorted.</tt>
                                </dd>
                            </dl>

                            <dl>
                                <dt><a name="StreamingSound-get_length"><strong>get_length</strong></a>(self)</dt>
                                <dd><tt>Return the length of the sound stream in samples<br>
                                         <br>
                                        Only available for MP3 streams, not WAV ones.  To convert<br>
                                        result to seconds, divide by the samplerate and then divide by<br>
                                        2.</tt></dd>
                            </dl>

                            <dl>
                                <dt><a name="StreamingSound-play"><strong>play</strong></a>(self, volume<font
                                        color="#909090">=1.0</font>, offset<font color="#909090">=0</font>, fadein<font
                                        color="#909090">=0</font>, envelope<font color="#909090">=None</font>, loops
                                    <font color="#909090">=0</font>)</dt>
                                <dd><tt>Play the sound stream<br>
                                         <br>
                                        Keyword arguments:<br>
                                        volume - volume to play sound at<br>
                                        offset - sample to start playback<br>
                                        fadein - number of samples to slowly fade in volume<br>
                                        envelope - a list of [offset, volume] pairs defining<br>
                                                   a linear volume envelope<br>
                                        loops - how many times to play the sound (-1 is infinite)</tt>
                                </dd>
                            </dl>

                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    <p>
    <table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
        <tr bgcolor="#eeaa77">
            <td colspan=3 valign=bottom> <br>
                <font color="#ffffff" face="helvetica, arial"><big><strong>Functions</strong></big></font>
            </td>
        </tr>

        <tr>
            <td bgcolor="#eeaa77"><tt>      </tt></td>
            <td> </td>
            <td width="100%">
                <dl>
                    <dt><a name="-calc_vol"><strong>calc_vol</strong></a>(t, env)</dt>
                    <dd><tt>Calculate volume at time t given envelope env<br>
                             <br>
                            envelope is a list of [time, volume] points<br>
                            time is measured in samples<br>
                            envelope should be sorted by time</tt></dd>
                </dl>
                <dl>
                    <dt><a name="-get_microphone"><strong>get_microphone</strong></a>()</dt>
                    <dd><tt>Return raw data from microphone as Numpy array<br>
                             <br>
                            Default format will be 16-bit signed mono.  Format will match<br>
                            audio playback.  You must call <a
                                href="#-tick">tick</a>() every frame to update the<br>
                            results from this function.</tt></dd>
                </dl>
                <dl>
                    <dt><a name="-init"><strong>init</strong></a>(samplerate<font color="#909090">=44100</font>,
                        chunksize<font color="#909090">=1024</font>, stereo<font color="#909090">=True</font>,
                        microphone<font color="#909090">=False</font>, input_device_index<font color="#909090">=None
                        </font>, output_device_index<font color="#909090">=None</font>)</dt>
                    <dd><tt>Initialize mixer<br>
                             <br>
                            Must be called before any sounds can be played or loaded.<br>
                             <br>
                            Keyword arguments:<br>
                            samplerate - samplerate to use for playback (default 22050)<br>
                            chunksize - size of playback chunks<br>
                              smaller is more responsive but perhaps stutters<br>
                              larger is more buffered, less stuttery but less responsive<br>
                              Can be any size, does not need to be a power of two. (default 1024)<br>
                            stereo - whether to play back in stereo<br>
                            microphone - whether to enable microphone recording</tt></dd>
                </dl>
                <dl>
                    <dt><a name="-interleave"><strong>interleave</strong></a>(left, right)</dt>
                    <dd><tt>Given two separate arrays, return a new interleaved array<br>
                             <br>
                            This function is useful for converting separate left/right audio<br>
                            streams into one stereo audio stream.  Input arrays and returned<br>
                            array are Numpy arrays.<br>
                             <br>
                            See also: <a href="#-uninterleave">uninterleave</a>()</tt></dd>
                </dl>
                <dl>
                    <dt><a name="-microphone_off"><strong>microphone_off</strong></a>()</dt>
                    <dd><tt>Turn off microphone</tt></dd>
                </dl>
                <dl>
                    <dt><a name="-microphone_on"><strong>microphone_on</strong></a>()</dt>
                    <dd><tt>Turn on microphone<br>
                             <br>
                            Schedule audio input during main mixer tick.</tt></dd>
                </dl>
                <dl>
                    <dt><a name="-quit"><strong>quit</strong></a>()</dt>
                    <dd><tt>Stop all playback and terminate mixer</tt></dd>
                </dl>
                <dl>
                    <dt><a name="-resample"><strong>resample</strong></a>(smp, scale<font color="#909090">=1.0</font>)
                    </dt>
                    <dd><tt>Resample a sound to be a different length<br>
                             <br>
                            Sample must be mono.  May take some time for longer sounds<br>
                            sampled at 44100 Hz.<br>
                             <br>
                            Keyword arguments:<br>
                            scale - scale factor for length of sound (2.0 means double length)</tt>
                    </dd>
                </dl>
                <dl>
                    <dt><a name="-set_chunksize"><strong>set_chunksize</strong></a>(size<font color="#909090">=1024
                        </font>)</dt>
                    <dd><tt>Set the audio chunk size for each frame of audio output<br>
                             <br>
                            This function is useful for setting the framerate when audio output<br>
                            is synchronized with video.</tt></dd>
                </dl>
                <dl>
                    <dt><a name="-start"><strong>start</strong></a>()</dt>
                    <dd><tt>Start separate mixing thread</tt></dd>
                </dl>
                <dl>
                    <dt><a name="-stereo_to_mono"><strong>stereo_to_mono</strong></a>(left, right)</dt>
                    <dd><tt>Return mono array from left and right sound stream arrays</tt>
                    </dd>
                </dl>
                <dl>
                    <dt><a name="-tick"><strong>tick</strong></a>(extra<font color="#909090">=None</font>)</dt>
                    <dd><tt>Main loop of mixer, mix and do audio IO<br>
                             <br>
                            Audio sources are mixed by addition and then clipped.  Too many<br>
                            loud sources will cause distortion.<br>
                             <br>
                            extra is for extra sound data to mix into output<br>
                              must be in numpy array of correct length</tt>
                    </dd>
                </dl>
                <dl>
                    <dt><a name="-uninterleave"><strong>uninterleave</strong></a>(data)</dt>
                    <dd><tt>Given a stereo array, return separate left and right streams<br>
                             <br>
                            This function converts one array representing interleaved left and<br>
                            right audio streams into separate left and right arrays.  The return<br>
                            value is a list of length two.  Input array and output arrays are all<br>
                            Numpy arrays.<br>
                             <br>
                            See also: <a href="#-interleave">interleave</a>()</tt></dd>
                </dl>
            </td>
        </tr>
    </table>
    <p>
    <table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
        <tr bgcolor="#55aa55">
            <td colspan=3 valign=bottom> <br>
                <font color="#ffffff" face="helvetica, arial"><big><strong>Data</strong></big></font>
            </td>
        </tr>

        <tr>
            <td bgcolor="#55aa55"><tt>      </tt></td>
            <td> </td>
            <td width="100%"><strong>gchannels</strong> = 1<br>
                <strong>gchunksize</strong> = 1024<br>
                <strong>gid</strong> = 1<br>
                <strong>ginit</strong> = False<br>
                <strong>ginput_device_index</strong> = None<br>
                <strong>glock</strong> = &lt;thread.lock object at 0xb7d540b0&gt;<br>
                <strong>gmic</strong> = False<br>
                <strong>gmicdata</strong> = None<br>
                <strong>gmicstream</strong> = None<br>
                <strong>gmixer_srcs</strong> = []<br>
                <strong>goutput_device_index</strong> = None<br>
                <strong>gpyaudio</strong> = None<br>
                <strong>gsamplerate</strong> = 44100<br>
                <strong>gsamplewidth</strong> = 2<br>
                <strong>gstereo</strong> = True<br>
                <strong>gstream</strong> = None</td>
        </tr>
    </table>
</body>

</html>